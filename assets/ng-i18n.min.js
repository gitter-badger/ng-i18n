/*
ng-i18n - git@github.com:kevinchappell/ng-i18n.git
Version: 1.0.0
Author: Kevin Chappell <kevin.b.chappell@gmail.com>
*/
angular.module("ngI18n",[]).provider("I18N",function(){"use strict";function n(n,t){function r(n){var e={"{":"\\{","}":"\\}","|":"\\|"};return n.replace(/\{|\}|\|/g,function(n){return e[n]})}var o=this,u={},a=n.lang||sessionStorage.getItem("locale")||"en-us",i="#__locale__#",s="#__name__#",c={};return o.loaded=[],c.fromFile=function(n){for(var e,t=n.split("\n"),r={},o=0;o<t.length;o++)e=t[o].match(/^(.+?) *?= *?([^\n]+)/),e&&(r[e[1]]=e[2].replace(/^\s+|\s+$/,""));return r},c.toFile=function(n){var e=[];for(var t in n)n.hasOwnProperty(t)&&e.push(t+" = "+n[t]);return e.join("\n")},c.processFile=function(e){e.replace(/\n\n/g,"\n");var t=c.fromFile(e),r=t[i];a=r,u[r]||(u[r]=t,o.loaded.push({locale:r,name:t[s]})),n.lang=r},o.getCurrent=function(){return a},o.getLangs=function(){return e.langs},o.loadLang=function(n){return t.get(e.langsDir+n,{cache:!0}).success(function(n){c.processFile(n)}).error(function(n,e){console.error(e+": "+n)})},o.get=function(n){var e=u[a]&&u[a][n]||u["en-us"]&&u["en-us"][n]||n;return e},o.parseArgs=function(n,e){var t,u,a,i=o.get(n);if("string"==typeof i)return t=i.match(/\{[^\}]+?\}/g),"object"==typeof e?angular.forEach(t,function(n){u=n.substring(1,n.length-1),a=e[u],i=i.replace(new RegExp(r(n),"g"),a||"")}):i=i.replace(/\{[^\}]+?\}/g,e),i},o.setCurrent=function(n,e){var t=this.loadLang(n);t.then(function(t){return window.sessionStorage.setItem("locale",n),"function"==typeof e?e(t):void 0},function(n){console.error("Failed: "+n)})},o.setCurrent(a),"test"===e.env&&(o.utils=c),o}var e={langsDir:"lang/","default":{locale:"en-us",name:"English"},langs:[{locale:"en-us",name:"English"},{locale:"pt-pt",name:"Portuguese"}]};this.config=function(n){return angular.extend(e,n)},this.$get=["$rootScope","$http",function(e,t){return new n(e,t)}]}),angular.module("ngI18n").directive("ngI18n",["I18N",function(n){"use strict";return{restrict:"E",scope:{key:"@"},link:function(e,t,r){function o(){u=n.parseArgs(r.key,r),t.html(u)}var u;e.$watch(o)}}}]),angular.module("ngI18n").filter("i18n",["I18N",function(n){"use strict";var e=function(e,t){return e?n.parseArgs(e,t):void 0};return e.$stateful=!0,e}]);